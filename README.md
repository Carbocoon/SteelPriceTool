# 钢材数据智能提取工具 (Steel Price Tool)

本项目是一个基于 Python 和 Streamlit 开发的自动化数据处理工具，致力于解决不同钢材厂家价格表格式不统一的问题。通过智能识别算法，将各异的 Excel 报价单提取、清洗并转换为标准化的汇总模板，极大提高了数据整理效率。

##  主要功能

### 1. 多厂家智能匹配
支持多种特定格式的厂家报价单自动识别与提取：
- **正大制管**：识别镀锌管数据，支持“规格 | 价格 | 支数”格式。
- **亨旺**：支持“壁厚 | 过磅 | 理计”双重计价模式，自动区分焊管/镀锌管。
- **屹恒**：专为板材设计，支持多栏排版、合并单元格材质继承、分段品名识别（如低温容器板）。
- **福顺德**：支持复杂特定格式，自动清洗规格中的汉字干扰（如去除“散”字，提取提货地、品牌），智能识别型材、板材等多种类型。
- **通用策略**：提供三栏/四栏基础表格的通用提取能力。

### 2. 核心处理能力
- **智能解析**：自动识别品名、材质、规格（长宽厚）、产地/品牌、提货地。
- **价格标准化**：支持过磅价与理计价的区分提取，统一格式化为整数显示。
- **规格清洗**：自动处理全角符号、空格干扰，规范化规格描述（如“32A#”转“32#A”）。
- **模板生成**：输出包含几十个标准字段的通用模板，支持多等级价格预留。

### 3. 特色
- **拖拽上传**：支持批量上传多个 Excel 文件。
- **交互式预览**：提供类 Excel 的在线编辑功能，支持直接修改提取结果。
- **一键导出**：一键生成标准格式的 Excel/CSV 文件。

##  快速开始

### 环境配置
确保已安装 Python 3.8+。

### 安装依赖
```bash
pip install -r requirements.txt
```

### 启动应用
```bash
streamlit run app.py
```
应用启动后，浏览器将自动打开 `http://localhost:8501`。

##  使用说明

1.  **选择厂家**：在左侧边栏选择对应的供应商（如“屹恒”、“福顺德”等），这有助于提高识别准确率。
2.  **上传文件**：点击“浏览文件”或拖拽 Excel 价格表到上传区。
3.  **预览与编辑**：系统提取数据后会展示预览表格，您可以：
    *   检查“类型”、“品名”、“规格”、“价格”等关键信息。
    *   直接点击单元格修改错误数据。
4.  **下载结果**：确认无误后，点击底部的“确认无误，前往下载”按钮导出文件。

##  项目结构

```
SteelPriceTool/
├── app.py                  # Streamlit 主程序入口
├── requirements.txt        # 项目依赖
├── README.md               # 项目文档
├── data/                   # 示例/参考数据文件
└── data_processor/         # 核心处理逻辑包
    ├── __init__.py
    ├── batch.py            # 批量处理逻辑
    ├── core.py             # 核心处理类与模板生成
    ├── strategies.py       # 各厂家提取策略实现 (工厂模式)
    └── utils.py            # 工具函数 (规格解析等)
```

##  更新日志

- **v1.5 (2025-12-31)**: 新增“福顺德”厂家支持，优化汉字干扰清洗逻辑。
- **v1.4 (2025-12-29)**: 新增“屹恒”板材多栏表格支持，优化合并单元格识别。
- **v1.3 (2025-12-26)**: 新增“亨旺”厂家支持，UI 增加强制厂家选择校验。

##  在线访问
上传至GitHub，注册Streamlit Cloud后可在线访问。
